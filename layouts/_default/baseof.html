<!DOCTYPE html>
<html
  lang="es-ES"
  data-theme="dark"
  itemscope
  itemtype="https://schema.org/WebPage"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Título dinámico -->
    {{ $title := .Title }} {{ $description := .Site.Params.description }} {{ if
    eq .Kind "home" }} {{ $title = "Kasnia Project" }} {{ else }} {{ $title =
    printf "%s ─ Kasnia Project" .Title }} {{ if .Description }} {{ $description
    = .Description }} {{ else if .Summary }} {{ $description = .Summary }} {{
    end }} {{ end }}
    <title>{{ $title }}</title>

    <!-- Meta Description -->
    <meta name="description" content="{{ $description }}" />

    <!-- Meta Keywords -->
    <meta name="keywords" content="{{ .Site.Params.keywords }}" />

    <!-- Meta Author -->
    <meta name="author" content="{{ .Site.Params.author }}" />

    <!-- Meta Robots -->
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ .Permalink }}" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{{ if eq .Kind "home" }}website{{ else
    }}article{{ end }}" />
    <meta property="og:url" content="{{ .Permalink }}" />
    <meta property="og:title" content="{{ $title }}" />
    <meta property="og:description" content="{{ $description }}" />
    <meta property="og:image" content="{{ .Site.BaseURL }}img/icon/og.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="675" />
    <meta property="og:locale" content="{{ .Site.Params.seo.og_locale }}" />
    <meta property="og:site_name" content="Kasnia Project" />
    {{ if ne .Kind "home" }}
    <meta property="article:author" content="{{ .Site.Params.author }}" />
    <meta property="article:published_time" content="{{ .PublishDate.Format
    "2006-01-02T15:04:05Z07:00" }}" /> <meta property="article:modified_time"
    content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}" /> {{ end }}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="{{ .Permalink }}" />
    <meta name="twitter:title" content="{{ $title }}" />
    <meta name="twitter:description" content="{{ $description }}" />
    <meta name="twitter:image" content="{{ .Site.BaseURL }}img/icon/og.jpg" />

    <!-- Datos Estructurados JSON-LD -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Kasnia Project",
        "url": "{{ .Site.BaseURL }}",
        "logo": "{{ .Site.BaseURL }}img/icon/og.jpg",
        "description": "{{ .Site.Params.description }}",
        "sameAs": ["{{ .Site.Params.social.facebook }}"],
        "contactPoint": {
          "@type": "ContactPoint",
          "contactType": "Customer Service",
          "availableLanguage": ["Spanish"]
        }
      }
    </script>

    {{ if eq .Kind "home" }}
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Kasnia Project",
        "url": "{{ .Site.BaseURL }}",
        "description": "{{ .Site.Params.description }}",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "{{ .Site.BaseURL }}novelas?q={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>
    {{ end }}

    <!-- Favicon -->
    <link rel="icon" href="/img/icon/favicon.ico" type="image/x-icon" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/img/icon/apple-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/img/icon/favicon-32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/img/icon/favicon-16.png"
    />

    <!-- CSS común -->
    {{ $mainCSS := resources.Get "css/main.css" | minify | fingerprint }}
    <link rel="stylesheet" href="{{ $mainCSS.Permalink }}" />

    <!-- Bloque para CSS específicos -->
    {{ block "css" . }}{{ end }}

    <!-- JS común -->
    {{ $themeJS := resources.Get "js/theme.js" | minify | fingerprint }}
    <script src="{{ $themeJS.Permalink }}"></script>
  </head>
  <body>
    <!-- Header común -->
    <header>
      <nav class="navbar" aria-label="Navegación principal">
        <div class="navbarContainer">
          <a href="/" class="navbarLogo" aria-label="Ir a la página principal">
            <svg class="logo" viewBox="0 0 793.4 543.8">
              <use href="/img/svg/main.svg#logo" />
            </svg>
          </a>

          <div class="navbarRight">
            <ul class="navbarLinks">
              <li><a href="/novelas">Novelas</a></li>
              <li><a href="/staff">Staff</a></li>
              <li><a href="/donaciones">Donaciones</a></li>
            </ul>

            <button
              class="themeToggle"
              id="themeToggle"
              aria-label="Cambiar tema"
            >
              <svg class="sunIcon">
                <use href="/img/svg/main.svg#sunIcon" />
              </svg>
              <svg class="moonIcon">
                <use href="/img/svg/main.svg#moonIcon" />
              </svg>
            </button>

            <button
              class="menuToggle"
              id="menuToggle"
              aria-label="Abrir menú"
              aria-expanded="false"
              aria-controls="mobileMenu"
            >
              <svg class="menuIcon">
                <use href="/img/svg/main.svg#menuIcon" />
              </svg>
              <svg class="closeIcon">
                <use href="/img/svg/main.svg#closeIcon" />
              </svg>
            </button>
          </div>
        </div>
      </nav>

      <nav class="mobileMenu" id="mobileMenu" aria-label="Menú móvil">
        <ul class="mobileMenuLinks">
          <li><a href="/novelas">Novelas</a></li>
          <li><a href="/staff">Staff</a></li>
          <li><a href="/donaciones">Donaciones</a></li>
        </ul>
      </nav>
    </header>

    <!-- Contenido de la página -->
    <main>{{ block "main" . }}{{ end }}</main>

    <!-- Modal de la página de descargas -->
    {{ if and (eq .Section "novelas") (eq .Kind "page") }}
    <div class="modalOverlay" id="downloadModal">
      <div class="modal">
        <div class="modalHeader">
          <h3 class="modalTitle" id="modalVolumeTitle">Volumen</h3>
          <button class="modalClose" aria-label="Cerrar modal">
            <svg><use href="/img/svg/novela.svg#closeIconModal" /></svg>
          </button>
        </div>
        <div class="creditsSection">
          <h4 class="creditsSectionTitle">Créditos</h4>
          <div class="creditsList" id="creditsContainer"></div>
        </div>
        <div class="serverToggle">
          <button class="serverBtn active" data-server="propio">
            Servidor Propio
          </button>
          <button class="serverBtn" data-server="drive">Google Drive</button>
        </div>
        <div class="downloadLinks">
          <a
            href="#"
            class="downloadLink"
            id="pdfDownloadLink"
            target="_blank"
            rel="noopener noreferrer"
          >
            <div class="downloadIcon pdf">
              <svg><use href="/img/svg/novela.svg#pdfIcon" /></svg>
            </div>
            <div class="downloadFormat">PDF</div>
          </a>
          <a
            href="#"
            class="downloadLink"
            id="epubDownloadLink"
            target="_blank"
            rel="noopener noreferrer"
          >
            <div class="downloadIcon epub">
              <svg><use href="/img/svg/novela.svg#epubIcon" /></svg>
            </div>
            <div class="downloadFormat">EPUB</div>
          </a>
        </div>
      </div>
    </div>
    {{ end }}

    <!-- Footer común -->
    <footer>
      <div class="footerContainer">
        <div class="footerContent">
          <div class="footerBrand">
            <a
              href="/"
              class="footerLogoLink"
              aria-label="Ir a la página principal"
            >
              <svg
                class="footerLogoSvg"
                viewBox="0 0 793.4 543.8"
                aria-label="Kasnia Project Logo"
              >
                <use href="/img/svg/main.svg#logo" />
              </svg>
            </a>
            <p class="footerDescription">
              Traduciendo novelas ligeras al español con calidad y dedicación.
              Únete a nuestra comunidad.
            </p>
          </div>

          <div class="footerLinksGroup">
            <div class="footerLinksSection">
              <h4 class="footerHeading">Navegación</h4>
              <ul class="footerList">
                <li><a href="/novelas" class="footerLink">Novelas</a></li>
                <li><a href="/staff" class="footerLink">Staff</a></li>
                <li><a href="/donaciones" class="footerLink">Donaciones</a></li>
              </ul>
            </div>

            <div class="footerLinksSection">
              <h4 class="footerHeading">Legal</h4>
              <ul class="footerList">
                <li><a href="/dmca" class="footerLink">DMCA</a></li>
                <li><a href="/privacy" class="footerLink">Privacidad</a></li>
              </ul>
            </div>
          </div>

          <div class="footerSocial">
            <h4 class="footerHeading">Síguenos</h4>
            <div class="socialIconsContainer">
              <a
                href="https://www.facebook.com/profile.php?id=61569583498113"
                target="_blank"
                rel="noopener noreferrer"
                class="socialLink"
                aria-label="Facebook"
              >
                <svg class="footerIcon">
                  <use href="/img/svg/main.svg#facebookIcon"></use>
                </svg>
              </a>
            </div>
          </div>
        </div>

        <div class="footerBottom">
          <p>&copy; 2026 Kasnia Project. Todos los derechos reservados.</p>
        </div>
      </div>
    </footer>

    <div class="backToTopContainer">
      <button id="backToTop" class="backToTop" aria-label="Volver arriba">
        <svg>
          <use href="/img/svg/main.svg#arrowUp" />
        </svg>
      </button>
    </div>

    <!-- JS común -->
    {{ $mainJS := resources.Get "js/main.js" | minify | fingerprint }}
    <script src="{{ $mainJS.Permalink }}"></script>

    <!-- Bloque para JS específicos -->
    {{ block "js" . }}{{ end }}
  </body>
</html>
